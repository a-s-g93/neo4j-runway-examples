server_uri: bolt://localhost:7687
admin_user: neo4j
admin_pass: password
basepath: file:./

pre_ingest:
  - CREATE CONSTRAINT person_name IF NOT EXISTS FOR (n:Person) REQUIRE n.name IS UNIQUE;
  - CREATE CONSTRAINT address_name IF NOT EXISTS FOR (n:Address) REQUIRE n.name IS UNIQUE;
  - CREATE CONSTRAINT pet_name IF NOT EXISTS FOR (n:Pet) REQUIRE n.name IS UNIQUE;
  - CREATE CONSTRAINT toy_name IF NOT EXISTS FOR (n:Toy) REQUIRE n.name IS UNIQUE;
files:
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows AS row
    MERGE (n:Person {name: row.name})
    SET n.age = row.age
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows AS row
    MERGE (n:Address {name: row.name})
    SET n.street = row.street, n.city = row.city
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows AS row
    MERGE (n:Pet {name: row.name})
    SET n.kind = row.kind, n.name = row.name
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows AS row
    MERGE (n:Toy {name: row.name})
    SET n.kind = row.kind
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows as row
    MATCH (source:Person{name: row.name})
    MATCH (target:Address{name: row.name})
    MERGE (source)-[:HAS_ADDRESS]->(target)
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows as row
    MATCH (source:Person{name: row.name})
    MATCH (target:Person{name: row.name})
    MERGE (source)-[:KNOWS]->(target)
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows as row
    MATCH (source:Person{name: row.name})
    MATCH (target:Pet{name: row.name})
    MERGE (source)-[:HAS_PET]->(target)
  url: $BASE/data/None
- chunk_size: 100
  cql: |-
    WITH $dict.rows AS rows
    UNWIND rows as row
    MATCH (source:Pet{name: row.name})
    MATCH (target:Toy{name: row.name})
    MERGE (source)-[:PLAYS_WITH]->(target)
  url: $BASE/data/None
